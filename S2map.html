<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Alliance Map</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="S2mapstyle.css">
</head>
<body class="sidebar-active"> <!-- Add assignment-order-active class here via JS -->
    <div id="map-container">
        <div id="map-grid">
            <!-- Map segments will be generated here by JavaScript -->
        </div>
    </div>

    <div id="alliance-summary">
        <!-- Toggle switch for fixed alliances -->
        <div class="fixed-toggle-container p-1 border-bottom">
            <div class="form-check form-switch">
                <input class="form-check-input mt-1" type="checkbox" role="switch" id="fixed-alliance-toggle" checked>
                <label class="form-check-label small mt-0" for="fixed-alliance-toggle"> Designated War Palace</label>
            </div>
        </div>
        <!-- NEW Toggle switch for assignment order -->
        <div class="fixed-toggle-container p-1 border-bottom">
            <div class="form-check form-switch">
                <input class="form-check-input mt-1" type="checkbox" role="switch" id="assignment-order-toggle"> <!-- New ID -->
                <label class="form-check-label small mt-0" for="assignment-order-toggle"> Show Assignment Order</label> <!-- New Label -->
            </div>
        </div>
        <!-- Container for alliance summary items (generated by JS) -->
        <!-- summary-item-container will be appended here by JS -->
    </div>

    <!-- Sidebar Toggle Button -->
    <button class="btn btn-secondary" id="sidebar-toggle" type="button" title="Toggle Alliance Summary">
        <i class="fa-solid fa-bars"></i>
    </button>

    <!-- Clear All Assignments Button -->
    <button class="btn btn-danger" id="clear-all-button" type="button" title="Clear All User Assignments">
        <i class="fa-solid fa-trash"></i>
    </button>

    <!-- Alliance Selection Modal -->
    <div class="modal fade" id="allianceSelectModal" tabindex="-1" aria-labelledby="allianceSelectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="allianceSelectModalLabel">
                        <span id="modalSegmentId"></span> -
                        Level <span id="modalSegmentLevel"></span>
                        <span id="modalSegmentName"></span> -
                        Buff: <span id="modalSegmentBuff"></span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Production:</strong> <span id="modalSegmentProd"></span></p>
                    <p><strong>Resistance Required:</strong> <span id="modalSegmentResistance"></span></p>
                    <hr>
                    <p>Select alliance to occupy this segment:</p>
                    <div id="alliance-buttons" class="d-grid gap-2">
                        <!-- Alliance buttons will be generated here by JavaScript -->
                    </div>
                     <button type="button" class="btn btn-secondary w-100 mt-3" id="clear-alliance-button">Clear Assignment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- External Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src='https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.5.1/dist/panzoom.min.js'></script>
    <script src="S2mapscript.js"></script>
</body>
</html>