<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>899Events.com</title>
    <link rel="icon" href="data:,">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="code/css/style.css">
</head>
<body>
    <div id="app-preloader">
        <div class="spinner"></div>
    </div>

    <div id="app-container">
        <canvas id="particle-canvas"></canvas>

        <!-- Mobile Nav Menu -->
        <div id="mobile-nav-menu" class="glass-pane !rounded-l-lg !rounded-r-none">
            <div class="p-4 flex justify-between items-center border-b border-white/10">
                <h3 class="text-xl font-bold text-white">Menu</h3>
                <button id="close-mobile-menu-btn" class="text-gray-400 hover:text-white"><i class="fas fa-times fa-lg"></i></button>
            </div>
            <nav id="mobile-nav-links" class="flex flex-col p-2"></nav>
        </div>

        <!-- Modals Container -->
        <div id="modal-container-all">
            <div id="emoji-picker-container" class="absolute z-[2000]" style="display: none;">
                <emoji-picker class="light"></emoji-picker>
            </div>
            <div id="reaction-picker-container" class="reaction-picker" style="display: none;">
                <span class="emoji-option" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</span>
                <span class="emoji-option" data-emoji="üëç">üëç</span>
                <span class="emoji-option" data-emoji="üòÇ">üòÇ</span>
            </div>
            <!-- Auth & Edit Modals -->
            <div id="modal-backdrop" class="modal-backdrop"></div>
            <div id="auth-modal-container" class="modal-container">
                <div class="glass-pane">
                    <div class="modal-content-wrapper">
                        <button id="close-auth-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-white transition-colors z-10">
                            <i class="fas fa-times fa-lg"></i>
                        </button>
                        <div id="login-form-container" class="auth-form active">
                            <h2 class="text-2xl font-bold text-white text-center mb-6">Welcome Back</h2>
                            <form id="login-form">
                                <div class="space-y-4">
                                    <div class="input-group"><i class="fas fa-envelope input-icon"></i><input type="email" id="login-email" placeholder="Email" class="form-input" required></div>
                                    <div class="input-group"><i class="fas fa-lock input-icon"></i><input type="password" id="login-password" placeholder="Password" class="form-input" required></div>
                                </div>
                                <div class="text-right mt-2"><a href="#" id="forgot-password-link" class="text-xs text-blue-400 hover:underline">Forgot Password?</a></div>
                                <p id="login-error" class="text-red-400 text-center text-sm mt-4 form-error"></p>
                                <button id="login-submit-btn" type="submit" class="w-full p-3 rounded-lg primary-btn mt-6">Login</button>
                                <p class="text-center text-sm text-gray-400 mt-6">Don't have an account? <a href="#" id="show-register-link" class="font-bold text-blue-400 hover:underline">Sign Up</a></p>
                            </form>
                        </div>
                        <div id="register-form-container" class="auth-form">
                            <div id="registration-flow">
                                <div class="progress-bar mb-6">
                                    <div class="line"></div>
                                    <div class="progress-step active"><i class="fas fa-user-circle"></i></div>
                                    <div class="progress-step"><i class="fas fa-shield-alt"></i></div>
                                    <div class="progress-step"><i class="fas fa-fist-raised"></i></div>
                                    <div class="progress-step"><i class="fas fa-image"></i></div>
                                </div>
                                <form id="register-form">
                                    <div class="form-slide active" data-slide="1">
                                        <h3 class="text-xl font-bold text-white text-center mb-4">Account Info</h3>
                                        <div class="space-y-4">
                                            <div class="input-group"><i class="fas fa-user input-icon"></i><input type="text" id="register-username" placeholder="Username" class="form-input" required></div>
                                            <div class="input-group"><i class="fas fa-envelope input-icon"></i><input type="email" id="register-email" placeholder="Email" class="form-input" required></div>
                                            <div class="input-group"><i class="fas fa-lock input-icon"></i><input type="password" id="register-password" placeholder="Password" class="form-input" required></div>
                                            <div class="input-group"><i class="fas fa-check-circle input-icon"></i><input type="password" id="register-password-verify" placeholder="Verify Password" class="form-input" required></div>
                                        </div>
                                    </div>
                                    <div class="form-slide" data-slide="2">
                                        <h3 class="text-xl font-bold text-white text-center mb-4">Alliance Info</h3>
                                        <div class="space-y-4">
                                            <div class="input-group"><i class="fas fa-shield-alt input-icon"></i>
                                                <div class="custom-select-container" data-type="alliance">
                                                    <input type="hidden" id="register-alliance" name="alliance" required><button type="button" class="custom-select-value form-input"><span>Select Alliance</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><input type="text" class="custom-select-search" placeholder="Search alliances..."><div class="options-list"></div></div>
                                                </div>
                                            </div>
                                            <div class="input-group"><i class="fas fa-star input-icon"></i>
                                                <div class="custom-select-container" data-type="rank">
                                                    <input type="hidden" id="register-alliance-rank" name="alliance-rank" required><button type="button" class="custom-select-value form-input"><span>Select Alliance Rank</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><div class="options-list"></div></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-slide" data-slide="3">
                                        <h3 class="text-xl font-bold text-white text-center mb-4">Player Power</h3>
                                        <div class="space-y-4">
                                            <div class="input-group"><i class="fas fa-fist-raised input-icon"></i><input type="text" id="register-power" placeholder="Total Power" class="power-input form-input" required></div>
                                            <div class="input-group"><i class="fas fa-truck-monster input-icon"></i><input type="text" id="register-tank-power" placeholder="Tank Power (Optional)" class="power-input form-input"></div>
                                            <div class="input-group"><i class="fas fa-fighter-jet input-icon"></i><input type="text" id="register-air-power" placeholder="Air Power (Optional)" class="power-input form-input"></div>
                                            <div class="input-group"><i class="fas fa-rocket input-icon"></i><input type="text" id="register-missile-power" placeholder="Missile Power (Optional)" class="power-input form-input"></div>
                                        </div>
                                    </div>
                                    <div class="form-slide" data-slide="4">
                                        <h3 class="text-xl font-bold text-white text-center mb-4">Choose Avatar</h3>
                                        <div class="flex flex-col items-center gap-4">
                                            <img id="register-avatar-preview" src="https://placehold.co/128x128/161B22/FFFFFF?text=Avatar" class="w-32 h-32 rounded-full object-cover border-4 border-white/20">
                                            <button type="button" id="register-avatar-btn" class="w-full p-3 rounded-lg secondary-btn"><i class="fas fa-upload mr-2"></i>Choose Image</button>
                                            <input type="file" id="register-avatar-input" class="hidden" accept="image/*">
                                        </div>
                                    </div>
                                    <p id="register-error" class="text-red-400 text-center text-sm mt-4 form-error"></p>
                                    <div class="flex items-center mt-6">
                                        <button type="button" id="register-back-btn" class="px-6 py-3 rounded-lg secondary-btn">Back</button>
                                        <div class="flex-grow text-right">
                                            <button type="button" id="register-next-btn" class="px-6 py-3 rounded-lg primary-btn">Next</button>
                                            <button type="submit" id="register-submit-btn" class="px-6 py-3 rounded-lg primary-btn hidden"><i class="fas fa-check-circle mr-2"></i>Register</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div id="registration-success" class="text-center" style="display: none;">
                                <div class="w-16 h-16 bg-green-500/20 text-green-400 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl animate-[success-pop_0.5s_ease-out_forwards]">
                                    <i class="fas fa-check"></i>
                                </div>
                                <h2 class="text-2xl font-bold text-white mb-2">Registration Successful!</h2>
                                <p class="text-gray-400">Please check your email to verify your account. You will be logged in automatically.</p>
                            </div>
                            <p class="text-center text-sm text-gray-400 mt-6">Already have an account? <a href="#" id="show-login-link" class="font-bold text-blue-400 hover:underline">Log In</a></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="edit-profile-modal-container" class="modal-container">
                 <div class="glass-pane">
                    <div class="modal-content-wrapper">
                        <button id="close-edit-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-white transition-colors z-10">
                            <i class="fas fa-times fa-lg"></i>
                        </button>
                        <div class="modal-content-scroll">
                            <h2 class="text-2xl font-bold text-white text-center mb-6">Edit Your Profile</h2>
                            <form id="edit-profile-form">
                                 <div class="space-y-4">
                                    <div class="input-group"><i class="fas fa-user input-icon"></i><input type="text" id="edit-username" placeholder="Username" class="form-input" required></div>
                                    <div class="input-group"><i class="fas fa-shield-alt input-icon"></i>
                                        <div class="custom-select-container w-full" data-type="alliance">
                                            <input type="hidden" id="edit-alliance" name="alliance" required>
                                            <button type="button" class="custom-select-value form-input"><span>Select Alliance</span><i class="fas fa-chevron-down text-xs"></i></button>
                                            <div class="custom-select-options dropdown-pane glass-pane">
                                                <input type="text" class="custom-select-search" placeholder="Search alliances...">
                                                <div class="options-list"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="input-group"><i class="fas fa-star input-icon"></i>
                                         <div class="custom-select-container w-full" data-type="rank">
                                            <input type="hidden" id="edit-alliance-rank" name="alliance-rank" required>
                                            <button type="button" class="custom-select-value form-input"><span>Select Alliance Rank</span><i class="fas fa-chevron-down text-xs"></i></button>
                                            <div class="custom-select-options dropdown-pane glass-pane">
                                                <div class="options-list"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="input-group"><i class="fas fa-fist-raised input-icon"></i><input type="text" id="edit-power" placeholder="Total Power" class="power-input form-input" required></div>
                                    <div class="input-group"><i class="fas fa-truck-monster input-icon"></i><input type="text" id="edit-tank-power" placeholder="Tank Power" class="power-input form-input" required></div>
                                    <div class="input-group"><i class="fas fa-fighter-jet input-icon"></i><input type="text" id="edit-air-power" placeholder="Air Power" class="power-input form-input" required></div>
                                    <div class="input-group"><i class="fas fa-rocket input-icon"></i><input type="text" id="edit-missile-power" placeholder="Missile Power" class="power-input form-input" required></div>
                                </div>
                                <p id="edit-profile-error" class="text-red-400 text-center text-sm mt-4 form-error"></p>
                                <button type="submit" class="w-full p-3 rounded-lg primary-btn mt-6">Save Changes</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div id="player-settings-modal-container" class="modal-container">
                 <div class="glass-pane">
                    <div class="modal-content-wrapper">
                        <button id="close-player-settings-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-white transition-colors z-10">
                            <i class="fas fa-times fa-lg"></i>
                        </button>
                        <div class="modal-content-scroll">
                            <h2 class="text-2xl font-bold text-white text-center mb-2">Player Settings</h2>
                            <p id="player-settings-username" class="text-center text-gray-400 mb-6"></p>
                            <form id="player-settings-form">
                                 <div class="space-y-4">
                                    <div class="input-group"><i class="fas fa-star input-icon"></i>
                                         <div class="custom-select-container w-full" data-type="rank">
                                            <input type="hidden" id="setting-alliance-rank" name="alliance-rank" required>
                                            <button type="button" class="custom-select-value form-input"><span>Select Alliance Rank</span><i class="fas fa-chevron-down text-xs"></i></button>
                                            <div class="custom-select-options">
                                                <div class="options-list"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="input-group"><i class="fas fa-user-tag input-icon"></i>
                                         <div class="custom-select-container w-full" data-type="role">
                                            <input type="hidden" id="setting-alliance-role" name="alliance-role">
                                            <button type="button" class="custom-select-value form-input"><span>Select Alliance Role</span><i class="fas fa-chevron-down text-xs"></i></button>
                                            <div class="custom-select-options">
                                                <div class="options-list"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="verification-toggle-container" class="flex items-center justify-between bg-gray-900/50 p-3 rounded-lg">
                                        <label for="setting-verified" class="font-semibold text-white">Verified Status</label>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="setting-verified">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <p id="player-settings-error" class="text-red-400 text-center text-sm mt-4 form-error"></p>
                                <button type="submit" class="w-full p-3 rounded-lg primary-btn mt-6">Save Settings</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create/Edit Post Modal -->
            <div id="create-post-modal-container" class="modal-container">
                 <div class="glass-pane">
                    <div class="modal-content-wrapper">
                        <button id="close-create-post-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-white transition-colors z-10">
                            <i class="fas fa-times fa-lg"></i>
                        </button>
                        <div class="modal-content-scroll">
                            <form id="create-post-form">
                                <div id="post-creation-flow">
                                     <!-- Slide 1: Main Type (Event vs Announcement) - SKIPPED IN NEW FLOW -->
                                    <div class="form-slide" data-slide="1">
                                        <h2 class="text-2xl font-bold text-white text-center mb-4">Create New Post</h2>
                                        <p class="text-center text-gray-400 mb-6">What would you like to create?</p>
                                        <div id="post-main-type-selection-container" class="space-y-4">
                                           <!-- Dynamically inserted buttons for Event/Announcement -->
                                        </div>
                                    </div>
                                    <!-- Slide 2: Sub-Type Selection -->
                                    <div class="form-slide" data-slide="2">
                                        <h2 id="post-subtype-header" class="text-2xl font-bold text-white text-center mb-4"></h2>
                                        <p class="text-center text-gray-400 mb-6">Select a category.</p>
                                        <div id="post-subtype-selection-container" class="space-y-3">
                                           <!-- Dynamically inserted sub-type buttons -->
                                        </div>
                                    </div>
                                    <!-- Slide 3: Content -->
                                    <div class="form-slide" data-slide="3">
                                        <h2 id="post-content-header" class="text-2xl font-bold text-white text-center mb-4"></h2>
                                        <p class="text-center text-gray-400 mb-6">Provide the details for your post.</p>
                                        <div class="space-y-4">
                                            <div id="post-alliance-group" class="input-group hidden"><i class="fas fa-shield-alt input-icon"></i>
                                                 <div class="custom-select-container w-full" data-type="alliance">
                                                    <input type="hidden" id="post-alliance" name="post-alliance">
                                                    <button type="button" class="custom-select-value form-input"><span>Select Alliance</span><i class="fas fa-chevron-down text-xs"></i></button>
                                                    <div class="custom-select-options">
                                                        <input type="text" class="custom-select-search" placeholder="Search alliances...">
                                                        <div class="options-list"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="input-group"><i class="fas fa-heading input-icon"></i><input type="text" id="post-title" placeholder="Title" class="form-input" required></div>
                                            <div class="input-group !items-start"><i class="fas fa-align-left input-icon pt-3"></i><textarea id="post-details" placeholder="Details..." class="form-textarea" required></textarea></div>
                                            <div>
                                                <p class="text-sm text-gray-400 mb-2">Thumbnail (Optional)</p>
                                                <div class="flex items-center gap-4">
                                                    <img id="post-thumbnail-preview" src="https://placehold.co/100x100/161B22/444444?text=PREVIEW" class="w-24 h-24 rounded-lg object-cover border-2 border-white/20">
                                                    <button type="button" id="post-thumbnail-btn" class="flex-grow p-3 rounded-lg secondary-btn">
                                                        <i class="fas fa-upload mr-2"></i> Choose Image
                                                    </button>
                                                    <input type="file" id="post-thumbnail-input" class="hidden" accept="image/*">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                     <!-- Slide 4: Timing (for events) -->
                                    <div class="form-slide" data-slide="4">
                                        <h2 class="text-2xl font-bold text-white text-center mb-4">Event Schedule</h2>
                                        <p class="text-center text-gray-400 mb-6">Set the schedule for your event.</p>
                                        <div id="post-timing-group" class="space-y-4">
                                             <div>
                                                <label class="text-sm font-semibold text-gray-400 mb-1 block">Start Time</label>
                                                <div class="flex gap-2">
                                                    <div class="input-group w-1/2"><i class="fas fa-calendar-day input-icon"></i>
                                                        <div class="custom-select-container" data-type="day-of-week">
                                                            <input type="hidden" id="post-start-day" required><button type="button" class="custom-select-value form-input"><span>Day</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><div class="options-list"></div></div>
                                                        </div>
                                                    </div>
                                                    <div class="input-group w-1/2"><i class="fas fa-clock input-icon"></i>
                                                        <div class="custom-select-container" data-type="hour-of-day">
                                                            <input type="hidden" id="post-start-hour" required><button type="button" class="custom-select-value form-input"><span>Hour</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><div class="options-list"></div></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="text-sm font-semibold text-gray-400 mb-1 block">End Time</label>
                                                <div class="flex gap-2">
                                                     <div class="input-group w-1/2"><i class="fas fa-calendar-day input-icon"></i>
                                                        <div class="custom-select-container" data-type="day-of-week">
                                                            <input type="hidden" id="post-end-day" required><button type="button" class="custom-select-value form-input"><span>Day</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><div class="options-list"></div></div>
                                                        </div>
                                                    </div>
                                                    <div class="input-group w-1/2"><i class="fas fa-clock input-icon"></i>
                                                        <div class="custom-select-container" data-type="hour-of-day">
                                                            <input type="hidden" id="post-end-hour" required><button type="button" class="custom-select-value form-input"><span>Hour</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><div class="options-list"></div></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                             <div>
                                                <label class="text-sm font-semibold text-gray-400 mb-1 block">Repetition</label>
                                                <div class="flex gap-2">
                                                     <div class="input-group w-1/2"><i class="fas fa-redo-alt input-icon"></i>
                                                        <div class="custom-select-container" data-type="repeat-type">
                                                            <input type="hidden" id="post-repeat-type" value="none" required><button type="button" class="custom-select-value form-input"><span>None</span><i class="fas fa-chevron-down text-xs"></i></button><div class="custom-select-options"><div class="options-list"></div></div>
                                                        </div>
                                                    </div>
                                                    <div id="post-repeat-weeks-container" class="input-group w-1/2 hidden"><i class="fas fa-hashtag input-icon"></i>
                                                        <input type="number" id="post-repeat-weeks" class="form-input" min="1" value="1" placeholder="Weeks">
                                                    </div>
                                                </div>
                                            </div>
                                            <p class="text-xs text-center text-gray-400">Times are based on your local timezone.</p>
                                        </div>
                                    </div>
                                </div>
                                <p id="create-post-error" class="text-red-400 text-center text-sm mt-4 form-error"></p>
                                 <div id="post-nav-container" class="flex items-center mt-6">
                                    <button type="button" id="post-back-btn" class="px-6 py-2 rounded-lg secondary-btn flex items-center"><i class="fas fa-arrow-left mr-2"></i>Back</button>
                                    <div class="flex-grow flex justify-center">
                                        <button type="button" id="post-next-btn" class="px-6 py-2 rounded-lg primary-btn flex items-center">Next<i class="fas fa-arrow-right ml-2"></i></button>
                                        <button type="submit" id="post-submit-btn" class="px-6 py-2 rounded-lg primary-btn hidden flex items-center"><i class="fas fa-check-circle mr-2"></i>Create Post</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Confirmation Modal -->
            <div id="confirmation-modal-container" class="modal-container">
                <div class="glass-pane">
                    <div class="modal-content-wrapper p-6 text-center">
                        <h2 id="confirmation-title" class="text-2xl font-bold text-white mb-4">Confirm Action</h2>
                        <p id="confirmation-message" class="text-gray-300 mb-6">Are you sure?</p>
                        <div class="flex justify-center gap-4">
                            <button id="confirmation-cancel-btn" class="w-full p-3 rounded-lg secondary-btn">Cancel</button>
                            <button id="confirmation-confirm-btn" class="w-full p-3 rounded-lg primary-btn bg-red-600 hover:bg-red-700 !shadow-red-500/30">Confirm</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Post Actions Modal -->
            <div id="post-actions-modal-container" class="modal-container" style="max-width: 300px;">
                <div class="glass-pane">
                    <div class="modal-content-wrapper p-4">
                        <h3 class="text-lg font-bold text-white text-center mb-4">Post Options</h3>
                        <div class="space-y-2">
                            <button id="modal-edit-post-btn" class="actions-modal-btn edit">
                                <i class="fas fa-edit fa-fw"></i>
                                <span>Edit Post</span>
                            </button>
                            <button id="modal-delete-post-btn" class="actions-modal-btn delete">
                                <i class="fas fa-trash-alt fa-fw"></i>
                                <span>Delete Post</span>
                            </button>
                        </div> 
                         <button id="close-post-actions-modal-btn" class="w-full p-2 rounded-lg secondary-btn mt-4">Cancel</button>
                    </div>
                </div>
            </div>
            
            <!-- Private Message Modal -->
        <div id="private-message-modal-container" class="modal-container !p-0" style="max-width: 500px; height: 85vh; max-height: 700px;">
                <div class="glass-pane flex flex-col h-full overflow-hidden">
                    <div id="private-message-header" class="flex items-center p-3 border-b border-white/10 flex-shrink-0">
                        <button id="close-private-message-modal-btn" class="text-gray-500 hover:text-white transition-colors mr-3 ml-1">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <img id="private-message-avatar" src="https://placehold.co/48x48/161B22/FFFFFF?text=?" class="w-10 h-10 rounded-full object-cover mr-3">
                        <div>
                            <h3 id="private-message-username" class="font-bold text-white leading-tight">Username</h3>
                            <p id="private-message-status" class="text-xs font-semibold leading-tight">Offline</p>
                        </div>
                    </div>
                    
                    <div id="private-message-window" class="chat-window flex-grow p-4">
                        </div>

                    <div id="private-message-footer" class="p-3 border-t border-white/10 bg-black/20 flex-shrink-0">
                        <form id="private-message-form" class="flex items-center gap-2">
                            <button type="button" id="private-message-attach-btn" class="pm-footer-btn" title="Attach Image">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <div class="relative flex-grow">
                                <input type="text" id="private-message-input" class="form-input !rounded-full !bg-gray-900/70" placeholder="Type a message..." required>
                                <button type="button" id="private-message-emoji-btn" class="absolute top-1/2 right-3 -translate-y-1/2 text-gray-400 hover:text-white">
                                    <i class="fas fa-smile"></i>
                                </button>
                            </div>
                            <button type="submit" class="pm-footer-btn !bg-blue-600 text-white" title="Send">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="relative min-h-screen w-full p-4 sm:p-6 lg:p-8">
            <div class="max-w-6xl mx-auto">

                <header class="glass-pane header-main flex justify-between items-center mb-6">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl md:text-3xl font-black tracking-tighter text-white" style="text-shadow: 0 0 10px var(--color-primary-glow);">899<span class="font-bold" style="color: var(--color-primary);">HUB</span></h1>
                        <p class="text-xs text-gray-400">Official Community Hub</p>
                    </div>
                    
                    <nav id="main-nav" class="hidden md:flex flex-grow justify-center items-center">
                        <div class="nav-item"><div class="nav-link active" data-main-target="page-events"><i class="fas fa-calendar-alt"></i><span>Events</span></div></div>
                        <div class="nav-item"><div class="nav-link" data-main-target="page-social"><i class="fas fa-comments"></i><span>Social</span></div></div>
                        <div class="nav-item"><div class="nav-link" data-main-target="page-players"><i class="fas fa-users"></i><span>Players</span></div></div>
                        <div class="nav-item" id="feed-nav-item">
                            <div class="nav-link" data-main-target="page-feed">
                                <i class="fas fa-bell"></i><span>Feed</span>
                                <span id="notification-badge" class="notification-badge"></span>
                            </div>
                            <div id="feed-dropdown" class="dropdown-menu dropdown-pane glass-pane">
                                <!-- Notifications will be rendered here -->
                                <p class="text-center text-gray-500 p-4">No new notifications.</p>
                            </div>
                        </div>
                    </nav>

                    <div id="mobile-controls-container" class="flex md:hidden items-center gap-4">
                        <div id="mobile-auth-container" class="hidden">
                             <img id="user-avatar-mobile" src="https://placehold.co/48x48/161B22/FFFFFF?text=?" class="w-8 h-8 rounded-full object-cover border-2 border-white/20" alt="User Avatar">
                        </div>
                        <button id="open-mobile-menu-btn" class="auth-button !px-4 gap-2"><i class="fas fa-bars"></i><span class="font-bold tracking-wider">MENU</span></button>
                    </div>

                    <div id="auth-container" class="hidden md:flex flex-shrink-0">
                         <button id="login-btn" class="auth-button"><i class="fas fa-sign-in-alt fa-fw mr-2"></i>Login</button>
                         <div id="user-profile-nav-item" class="nav-item hidden">
                            <button id="user-profile-button" class="auth-button">
                                 <img id="user-avatar-button" src="https://placehold.co/48x48/161B22/FFFFFF?text=?" class="w-6 h-6 rounded-full mr-2 object-cover" alt="User Avatar">
                                <span id="username-display"></span>
                                <i class="fas fa-caret-down ml-2 transition-transform"></i>
                            </button>
                            <div id="player-profile-dropdown" class="dropdown-menu dropdown-pane glass-pane">
                               <div class="p-2 mb-2 border-b border-white/10">
                                   <p class="text-sm text-gray-400">Total Power</p>
                                   <p id="profile-dropdown-power" class="text-lg font-bold text-white">0</p>
                               </div>
                               <button id="profile-dropdown-friends" class="dropdown-link profile-menu-link">
                                   <span><i class="fas fa-user-plus fa-fw w-6 text-center mr-2"></i>Friend Requests</span>
                                   <span class="badge hidden">0</span>
                               </button>
                               <button id="profile-dropdown-messages" class="dropdown-link profile-menu-link">
                                   <span><i class="fas fa-envelope fa-fw w-6 text-center mr-2"></i>Private Messages</span>
                                   <span class="badge hidden">0</span>
                               </button>
                               <button id="profile-dropdown-edit" class="dropdown-link profile-menu-link">
                                   <span><i class="fas fa-edit fa-fw w-6 text-center mr-2"></i>Edit Profile</span>
                               </button>
                               <button id="profile-dropdown-avatar" class="dropdown-link profile-menu-link">
                                   <span><i class="fas fa-camera fa-fw w-6 text-center mr-2"></i>Change Avatar</span>
                               </button>
                               <input type="file" id="avatar-upload-input" class="hidden" accept="image/*">
                               <div class="p-1"><hr class="border-t border-white/10"></div>
                               <button id="profile-dropdown-logout" class="dropdown-link profile-menu-link w-full text-left">
                                   <span><i class="fas fa-sign-out-alt fa-fw w-6 text-center mr-2"></i>Log Out</span>
                               </button>
                            </div>
                        </div>
                    </div>
                    </header>
                </div>
                <!-- Page Content Container -->
                <div id="page-container">
                    <!-- Feed Page -->
                    <div id="page-feed" class="page-content" style="display: none;">
                        <div id="feed-welcome-message" class="mb-8 text-center"></div>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div class="lg:col-span-1">
                                <h3 class="section-header text-xl font-bold mb-4" style="--glow-color: var(--color-highlight);">
                                    <i class="fas fa-exclamation-circle"></i>
                                    <span>Action Required</span>
                                </h3>
                                <div id="feed-action-container" class="space-y-3"><p class="text-center text-gray-500 py-4">No pending actions.</p></div>
                            </div>
                            <div class="lg:col-span-2">
                                <h3 class="section-header text-xl font-bold mb-4" style="--glow-color: var(--post-color-server);">
                                    <i class="fas fa-history"></i>
                                    <span>Feed Activity</span>
                                </h3>
                                <div id="feed-activity-container" class="space-y-3">
                                    <p class="text-center text-gray-500 py-4">No recent activity.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    
                    <!-- Social Page -->
                    <div id="page-social" class="page-content" style="display: none;">
                        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                            <div class="lg:col-span-1">
                                <div id="friends-list-container-social" class="glass-pane section-container flex flex-col">
                                    <div class="flex justify-between items-center mb-2">
                                        <h3 class="section-header !border-none !p-0 text-lg font-bold">
                                            <i class="fas fa-user-friends"></i>Friends
                                        </h3>
                                        <button id="collapse-friends-btn" class="lg:hidden text-gray-400 hover:text-white">
                                            <i class="fas fa-chevron-up"></i>
                                        </button>
                                    </div>
                                    <div id="friends-list-social-page" class="space-y-2 p-2 rounded-lg bg-black/20 flex-grow" style="height: 75vh; overflow-y: auto;">
                                        </div>
                                </div>
                            </div>

                            <div class="lg:col-span-3">
                                <div class="glass-pane section-container flex flex-col h-full">
                                    <div id="social-chat-selector" class="mb-4">
                                        </div>
                                    
                                    <div id="social-chat-pane" class="flex flex-col flex-grow">
                                        <div id="chat-window-main" class="chat-window p-4 flex-grow" style="height: 65vh;">
                                            <p class="text-center text-gray-500 m-auto">Select a chat to begin.</p>
                                        </div>
                                        <form id="chat-input-form" class="mt-4 flex items-center gap-2" style="display: none;">
                                            <div class="relative flex-grow">
                                                <input type="text" id="chat-input-main" class="form-input" placeholder="Type a message...">
                                                <button type="button" id="main-chat-emoji-btn" class="absolute top-1/2 right-3 -translate-y-1/2 text-gray-400 hover:text-white">
                                                    <i class="fas fa-smile"></i>
                                                </button>
                                            </div>
                                            <button type="submit" class="primary-btn px-6 rounded-lg"><i class="fas fa-paper-plane"></i></button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Players Page -->
                    <div id="page-players" class="page-content" style="display: none;">
                        <div class="glass-pane section-container">
                            <div class="text-center mb-8">
                                <h2 class="text-3xl font-bold text-white tracking-wider" style="text-shadow: 0 0 10px var(--color-primary);">PLAYERS OF 899</h2>
                                <div class="themed-line-break mx-auto mt-2"></div>
                            </div>

                            <div class="flex flex-col md:flex-row gap-4 mb-6">
                                <div class="input-group flex-grow">
                                    <i class="fas fa-search input-icon"></i>
                                    <input type="text" id="player-search-input" placeholder="Search by player name..." class="form-input">
                                </div>
                                <div class="input-group md:max-w-xs">
                                    <i class="fas fa-shield-alt input-icon"></i>
                                    <div class="custom-select-container" data-type="alliance-filter">
                                        <input type="hidden" id="alliance-filter" name="alliance-filter">
                                        <button type="button" class="custom-select-value form-input"><span>All Alliances</span><i class="fas fa-chevron-down text-xs"></i></button>
                                        <div class="custom-select-options">
                                            <div class="options-list"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="player-list-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                                 <!-- Player cards will be inserted here -->
                            </div>
                        </div>
                    </div>
                    <!-- Events Page -->
                    <div id="page-events" class="page-content">
                        <main id="events-main-container" class="space-y-6">
                            
                            <div id="filter-container" class="filter-btn-group">
                                <!-- Filter buttons will be dynamically inserted here -->
                            </div>

                            <div id="announcements-container" class="space-y-4">
                                <!-- Skeletons or announcement cards will be rendered here -->
                            </div>

                            <div id="events-section-container" class="space-y-4">
                                <!-- Skeletons or event group headers and lists will be rendered here -->
                            </div>

                        </main>
                    </div>
                </div>

                <footer class="text-center mt-12 py-4 border-t border-gray-800/50"><p class="text-gray-500">&copy; 2025 SWDesigns - 899 Community</p></footer>
            </div>
        </div>
    </div>
    <!-- Firebase SDK -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
    <script type="module" src="code/js/main.js"></script>
</body>
</html>
